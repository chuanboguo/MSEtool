% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SCA.R, R/SCA2.R
\name{SCA}
\alias{SCA}
\alias{SCA2}
\title{Statistical catch-at-age (SCA) model}
\usage{
SCA(x = 1, Data, U_begin = c("virgin", "est"),
  vulnerability = c("logistic", "dome"), SR = c("BH", "Ricker"),
  CAA_multiplier = 50, start = NULL, tau = 1, integrate = FALSE,
  silent = TRUE, control = list(eval.max = 1000), inner.control = list(),
  ...)

SCA2(x = 1, Data, U_begin = c("virgin", "est"),
  vulnerability = c("logistic", "dome"), SR = c("BH", "Ricker"),
  CAA_multiplier = 50, start = NULL, tau = 1, integrate = TRUE,
  silent = TRUE, control = list(eval.max = 1000), inner.control = list(),
  ...)
}
\arguments{
\item{x}{A position in the Data object (by default, equal to one for assessments).}

\item{Data}{An object of class Data.}

\item{U_begin}{Indicates how to handle the equilibrium harvest rate prior to the first
year of model. \code{"virgin"} fixes \code{U = 0} prior to year 1 while \code{"est"} will
estimate it.}

\item{vulnerability}{Whether estimated vulnerability is logistic or dome (double-normal).
See details for parameterization.}

\item{SR}{Stock-recruit function (currently only supports Beverton-Holt).}

\item{CAA_multiplier}{Numeric for data weighting of catch-at-age matrix. See details.}

\item{start}{Optional list of starting values. See details.}

\item{tau}{The standard deviation of the recruitment deviations from the estimated mean recruitment
or stock-recruit relationship (by default, euqal to one).}

\item{integrate}{Logical, whether the likelihood of the model integrates over the likelihood of
the recruitment deviations (thus, treating it as a state-space variable).}

\item{silent}{Logical, passed to \code{\link[TMB]{MakeADFun}}, whether TMB
will print trace information during optimization. Used for dignostics for model convergence.}

\item{control}{A named list of agruments for optimization to be passed to
\code{\link[stats]{nlminb}}.}

\item{inner.control}{A named list of arguments for optimization of the random effects, which
is passed on to \code{\link[TMB]{newton}}.}

\item{...}{Other arguments to be passed.}
}
\value{
An object of class \linkS4class{Assessment}.
}
\description{
A generic statistical catch-at-age model that uses catch, index, and catch-at-age composition
data. An annual harvest rate is calculated (assuming a pulse fishery) in lieu of an instantaneous
fishing mortality rate from continuous fishing as described in Forrest et al. (2008). Recruitment
deviations are estimated beginning in the year when age composition data are available. There are
several parameterizations for estimation of recruitment deviations, the stock-recruit relationship,
and reference points (see functions section below).
}
\details{
For the SCA model, the basic data inputs are catch (by weight), index
(by weight/biomass), and catch-at-age matrix (by numbers). Catches are
assumed to be known perfectly (the harvest rate in a given year is the ratio of the observed
catch to the vulnerable biomass at the beginning of the year), while the observation error
of the index is fixed based on the value of \code{CV_Ind} in the Data object.

The annual sample sizes of the catch-at-age matrix is provided to the model (used in the
likelihood for catch-at-age, assuming a multinomial distribution),
and is manipulated via argument \code{CAA_multiplier}. This argument is
interpreted in two different ways depending on the value provided.
If \code{CAA_multiplier > 1}, then this value will cap the annual sample sizes
to that number. If \code{CAA_multiplier <= 1}, then all the annual samples sizes
will be re-scaled by that number. By default, sample sizes are capped at 50.

Recruitment deviations are estimated beginning in the year when age composition are available.

Vulnerability can be specified to be either logistic or dome. If logistic, then the model
vector \code{vul_par} is of length 2, containing the ages of 50\% and 95\% vulnerability,
respectively. The age of 95\% vulnerability is an offset, i.e.,
\code{vul_95 = vul_par[1] + exp(vul_par[2])}.

With dome vulnerability, a double normal parameterization is used, where \code{vul_par}
is an estimated vector of length 4:
\itemize{
\item \code{vulpar[1]} \code{log(sd_asc)}, where sd_asc of the normal distribution function for the ascending limb
\item \code{vulpar[2]} \code{mu_asc}, mean of the normal distribution function for the ascending limb
\item \code{vulpar[3]} \code{mu_des}, mean of the normal distribution function for the descending limb.
This is parameterized as an offset, i.e., \code{mu_desc = mu_asc + exp(vulpar[3])} to ensure
\code{mu_desc > mu_asc}.
\item \code{vulpar[4]} \code{log(sd_des)}, where sd_des of the normal distribution function for the descending limb.
}

For \code{start}, a named list of starting values of estimates for:
\itemize{
\item \code{UMSY} Only for \code{SCA2}.
\item \code{MSY} Only for \code{SCA2}.
\item \code{meanR} Mean recruitment, only for \code{SCA}.
\item \code{U_equilibrium} (typically 0). See \code{U_begin} argument.
\item \code{vul_par} (length 2 vector for logistic or length 4 for dome, see above).
}
}
\section{Functions}{
\itemize{
\item \code{SCA}: The mean recruitment in the time series is estimated and recruitment deviations around this mean are estimated
(as penalized parameters similar to Cadigan 2016). This generally runs quickly. MSY reference points are estimated after the
assessment run, assuming that the recruitment in the first year of the model is the virgin recruitment.

\item \code{SCA2}: The parameterization by Forrest et al. (2008) is used where UMSY and MSY are leading parameters.
}}

\note{
Convergence problems may occur if perfect data are used (e.g., \code{Data@CV_Ind}
is very low).
}
\references{
Cadigan, N.G. 2016. A state-space stock assessment model for northern cod, including under-reported catches and
variable natural mortality rates. Canadian Journal of Fisheries and Aquatic Science 72:296-308.

Forrest, R.E., Martell, S.J.D., Melnychuk, M.C., and Walters, C.J. 2008.
An age-structured model with leading management parameters, incorporating
age-specific selectivity and maturity. Canadian Journal of Fisheries and Aquatic
Science 65:286-296.
}
\author{
Q. Huynh
}
